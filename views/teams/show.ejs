<section>
    <h2>Show Team:</h2>
    
    <%- include('../attachments/_attachmentTeams', { team: team }) %>
    <article class="teamShow">
      <ul>
        <li>Title: <b><%= team.title %></b></li>
        <li>Body: <b><%= team.body %></b></li>
        <li>Created At: <b><%= team.createdAt %></b></li>
        <li>Updated At: <b><%= team.updatedAt %></b></li>
        <li>Author: <b><%= team.author?.username ?? "Anonymous" %></b></li>
        <li>Admin User: <b><%= adminUser?.username ?? 'None' %></b></li>
        <li>Number of Tokens: <b><%= team.tokens %></b></li>
        <li>Number of Users: <b><%= team.numUsers %></b></li>
      </ul>
      
      <% if (locals.loginUser && !locals.isMember) { %> 
      <form method="post" action="/teams/<%= team.id %>/join">
        <button type="submit">Unirse al Equipo</button>
      </form>
      <% } %>

      <% if (locals.loginUser && locals.isMember) { %> 
        <form method="post" action="/teams/<%= team.id %>/leave">
            <button type="submit">Abandonar Equipo</button>
        </form>
      <% } %>

      <!-- Boton para donar tokens a un miembro del team -->
      
      <% if (locals.loginUser && locals.isMember) { %> 
        <!-- Formulario para donar tokens -->
        <div class="donation-form">
          <h3>Donate Tokens</h3>
          <form method="post" action="/teams/<%= team.id %>/donate">
              <div class="form-group">
                  <label for="recipient">Recipient:</label>
                  <select name="recipient" id="recipient">
                      <% teamMembers.forEach(member => { %>
                          <% if (member.user.id !== locals.loginUser.id) { %>
                              <option value="<%= member.user.id %>"><%= member.user.username %></option>
                          <% } %>
                      <% }) %>
                  </select>
              </div>
      
              <div class="form-group">
                  <label for="amount">Amount:</label>
                  <input type="number" name="amount" id="amount" min="1" max="<%= locals.loginUser.wallet %>" required>
              </div>
      
              <button type="submit" class="donate-button">Donate Tokens</button>
          </form>
        </div>
      <% } %>

      <!-- Tabla con los usuarios del equipo -->
      <table>
        <thead>
            <tr>
                <th>Username</th>
                <th>Wallet</th>
                <th>Tokens</th>
                <th>Reputation</th>
            </tr>
        </thead>
        <tbody>
            <% teamMembers.forEach(member => { %>
                <tr>
                    <td><%= member.user.username %></td>
                    <td><%= member.wallet %></td>
                    <td><%= member.tokens %></td>
                    <td><%= member.reputation %> %</td>
                </tr>
            <% }) %>
        </tbody>
    </table>
      
      <a href="/teams">Volver</a>
    </article>

  </section>
  